import os

FC=os.environ.get('FC')
WM=os.environ.get('WM')

fsources = ['module_velfg_superkernel-dyn.f95', 'velfg_driver-dyn.f95']


FLFLAGS = ['-Ofast','-flto']
FLFLAGS += ['-fopenmp','-DWITH_OPENMP'] # WM was 14; but it depends on the param values, the module needs to be patched for that
FLFLAGS += ['-DWM='+WM ]#, '-mcmodel=medium']
FFLAGS = FLFLAGS + ['-Wall','-cpp','-m64','-ffree-form','-ffree-line-length-0','-fconvert=little-endian','-frecord-marker=4']

# '-fopenmp','-mcmodel=medium',

envF=Environment(F95=FC,LINK=FC,LINKFLAGS=FLFLAGS,F95FLAGS=FFLAGS,F95PATH=['.' ,'/usr/local/include']) 

envF.Program('prog-dyn-omp.exe',fsources,LIBS=['m'],LIBPATH=['.' ,'/usr/lib','/usr/local/lib'])

